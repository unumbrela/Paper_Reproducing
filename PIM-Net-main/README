# PIM 论文复现指南

本项目旨在复现 PIM 论文的实验结果。请遵循以下步骤进行操作。

---

## 🚀 快速上手

### **1. 环境配置**

确保您的开发环境满足以下要求：
* **配置数据集路径**：在相关代码或配置文件中，正确设置您的数据集存放路径。
* **安装依赖**：安装项目所需的 Python 库和依赖包。建议使用 `pip install -r requirements.txt`（如果项目提供了该文件）。

### **2. 模型训练**
一定要注意已经配置好了train.py中的数据集路径
完成环境配置后，直接运行训练脚本即可开始：

```bash
python train.py
```
训练完成后，生成的模型权重文件将保存在 **`pth/polyp/`** 目录下。

### **3. 模型推理**

要使用训练好的模型进行推理，请执行以下操作：
1.  **修改权重路径**：打开 `test.py` 文件，将其中的模型权重路径指向您在 `pth/polyp/` 目录下保存的 `.pth` 文件。
2.  **指定测试图片**：在 `test.py` 中配置您需要测试的图片路径。
3.  **运行推理脚本**：
    ```bash
    python test.py
    ```
推理生成的预测结果图像将保存在 **`./results/`** 目录下。

---

## 📊 性能评估

要评估模型的预测效果，请运行评估脚本 `metric5.py`。

* **运行评估脚本**：执行以下命令，并确保指定了真实标签（Ground Truth）图像所在的路径。
    ```bash
    python metric5.py --gt-path /path/to/your/ground_truth_images
    ```
脚本会自动计算并输出各项性能指标。

---

## 💡 在自定义数据集上操作

如果您希望在自己的数据集上进行训练和测试，请进行以下适配：

* **方法一：生成索引文件 (推荐)**
    * 按照项目约定的格式，为您的数据集生成对应的 **`.txt`** 索引文件。该文件通常用于组织图像路径和标签。

* **方法二：修改数据加载器**
    * 直接修改代码中的 `Dataloader` 逻辑，使其能够适配您的数据存储结构和格式。

---

## 📈 UltraEdit 数据集测试结果

以下是在 **UltraEdit** 数据集上，使用我自己训练的epoch_30.pth取得的平均指标，作为参考：

| 指标 (Metric) | 平均值 (Average) |
| :--- | :--- |
| **✅ 成功处理图片** | 176 / 176 |
| **Accuracy (准确率)** | 0.8669 |
| **AUC (曲线下面积)** | 0.8971 |
| **F1-Score** | 0.7245 |
| **MCC (马修斯相关系数)** | 0.6183 |
| **IoU / mIoU (交并比)** | 0.6330 |
| **FPR (假阳性率)** | 0.1178 |
